\documentclass[12pt]{article}

% --- Language and Font ---
\usepackage{fontspec}        % For custom fonts
\setmainfont{Noto Sans}
\usepackage{xeCJK}
\usepackage{enumitem} % in preamble

% --- Layout and Spacing ---
\usepackage{geometry}
\geometry{margin=0.75in}
\usepackage{setspace}
\usepackage{multicol}
\setlength{\columnsep}{1em}

% --- Color and Style ---
\usepackage{xcolor}
\definecolor{pagebackground}{HTML}{eeeee2}
\definecolor{bracketcolor}{HTML}{A0A0A0}
\definecolor{boxbackground}{HTML}{FFFFFF}
\definecolor{boxborder}{HTML}{A0A0A0}
\definecolor{titlecolor}{HTML}{fdea4e}
\definecolor{myorange}{HTML}{ed6d00}
\definecolor{highlighteryellow}{RGB}{255,255,0}
\definecolor{highlightorange}{HTML}{d92710}

\usepackage{parcolumns}
% --- Graphics ---
\usepackage{tikz}
\usetikzlibrary{shapes.geometric, positioning}
\usepackage{soul}
\setulcolor{highlighteryellow}
\newcommand{\highlight}[2][1.5pt]{%
    \begingroup % Keep settings local to this command
    \setul{.4ex}{#1}% Set underline depth and thickness
    \ul{#2}% Apply the underline
    \endgroup
}


% 3. Define highlighting commands using colorbox (instead of \hl)
\newcommand{\hlOrange}[1]{\colorbox{highlightorange}{\textcolor{white}{#1}}}

% Custom tight highlight
\newcommand{\hlYellow}[1]{%
  \begingroup
  \setlength{\fboxsep}{1pt} % tighten the box spacing
  \colorbox{highlighteryellow}{#1}%
  \endgroup
}

% --- Boxes ---
\usepackage[most]{tcolorbox}

% --- Math and Formatting ---
\usepackage{amsmath}
\usepackage{ragged2e} % for \Justifying

% --- Custom Commands ---
\newcommand{\cent}[1]{%
  \begin{center}#1\end{center}
}

\newcommand{\bracketlabel}[1]{%
  \subsection*{}%
  \addcontentsline{toc}{section}{#1}%
  \cent{
  \begin{tikzpicture}
    \node[
      text=black,
      font=\sffamily\normalsize,
      align=center
    ] {\textcolor{bracketcolor}{【 #1】}};
  \end{tikzpicture}%
}
}

\usepackage{xparse}
\NewDocumentCommand{\myformula}{m}{
  \begin{tcolorbox}[
    colframe=boxborder,
    boxrule=0.4pt,
    colback=boxbackground,
    arc=0pt,
    left=4pt,
    right=4pt,
    top=4pt,
    bottom=4pt
  ]
  \[
  #1
  \]
  \end{tcolorbox}
}

\NewDocumentCommand{\mytextbox}{m}{
  \begin{tcolorbox}[
    colframe=myorange!60,
    colback=boxbackground,
    boxrule=3pt,
    arc=0pt,
    left=6pt,
    right=6pt,
    top=6pt,
    bottom=6pt,
    enhanced,
    sharp corners,
    breakable    % <-- Needed to allow line breaks and wrapping
  ]
  #1
  \end{tcolorbox}
}
\newcommand{\minipagebox}[2]{%
  \begin{minipage}[t]{#1}
    #2
  \end{minipage}%
}


\newcommand{\myBoxedTopic}[2]{%
    \stepcounter{section}% % Automatically increments the section counter for each call

    \vspace{1em} % Add some vertical space before the box for separation

    \noindent % Prevent leading indentation before the box
    \begin{minipage}{\textwidth} % Ensure the box spans the full text width
        \begin{tcolorbox}[
            colback=white,
            colframe=white,    % Light gray border
            boxrule=0.5pt,           % Border thickness
            sharp corners,           % No rounded corners
            width=\linewidth,        % Span full width of this minipage
            height=2.0cm,            % Fixed height for the main box (adjust as needed)
            valign=top,              % Align content to the top within the box
            left=5mm,                % Left padding for content
            right=5mm,               % Right padding for content
            top=3mm,                 % Top padding from the tcolorbox edge
            bottom=3mm,              % Bottom padding from the tcolorbox edge
            nobeforeafter,           % Prevents extra vertical space added by tcolorbox itself
        ]
            % --- Top Area with "ACCA" and "Last reviewed" ---
            \begin{tabular*}{\linewidth}{@{}l @{\extracolsep{\fill}} r@{}} % @{} removes extra column padding
                \textbf{ACCA - Financial Accounting} & {\scriptsize Last reviewed: #2} % Use #2 for the provided date
            \end{tabular*}

            \vspace{1mm} % Small vertical space before the horizontal line
            \hrule % The horizontal line
            \vspace{2mm} % Vertical space after the horizontal line

            % --- Bottom Area with Number, Main Title, and Score ---
            \begin{tabular*}{\linewidth}{@{}
                l@{\extracolsep{\fill}} % Column for number + main title
                r@{} % Column for score
            @{}}
                % The number automatically generated by \thesection, then the main title (#1)
                {\fontsize{12pt}{14pt}\selectfont \textbf{\thesection}\quad #1} % \thesection gives the current number
                & % Column separator for the number+title and the score
                {\scriptsize \textbf{80}/100 pts} % Score remains static as per your example
            \end{tabular*}
        \end{tcolorbox}
    \end{minipage}
    % You might want to add some space after the box before the next paragraph starts
    \vspace{1em} % Extra space after the box
}


\newtcolorbox{myyellowbox}[1][]{
  colback=yellow!10,
  colframe=yellow!80!black,
  boxrule=1.5pt,
  arc=4pt,
  left=6pt,
  right=6pt,
  top=6pt,
  bottom=6pt,
  enhanced,
  sharp corners,
  boxsep=4pt,
  breakable,      % <-- important for wrapping
  #1
}


\usepackage{eso-pic} % lets you draw directly on each page

\AddToShipoutPictureBG{%
  \begin{tikzpicture}[remember picture, overlay]
    % Draw orange rectangle across top of the page
    \fill[myorange] (current page.north west) rectangle ([yshift=-1.5cm]current page.north east);


  \end{tikzpicture}
}

